<!DOCTYPE html>
	<head>
		<meta charset='UTF-8'>
		<meta name='viewport' content="width=device-width, initial-scale=1, user-scalable=no, maximum-scale=1, minimum-scale=1">
		<meta name='description' content='Joule Surveys'>
		<meta name='author' content="N'chaka Benjamin">
		<title>Joule Survey API Integration and Display</title>
		<link href='https://fonts.googleapis.com/css?family=Merriweather|Noto+Serif+KR' rel='stylesheet'>
		<style>
			*,html{-webkit-transition:all 150ms;transition:all 150ms}body{background:url(https://joule.cma.ca/content/joule/en/boilerplates/joule-header/_jcr_content/main_par/header/logo.img.png/1521126087297.png) bottom right no-repeat #fce6ff;font-family:'Noto Serif KR',sans-serif}#startSurveyCtrl,h1,h2,h3{font-family:Merriweather,serif}#startSurveyCtrl{font-size:2em;margin:5em auto;display:block;padding:.2em;border-radius:.2em;cursor:pointer;background-color:#eee}#startSurveyCtrl:hover{background-color:#333;color:#fff}#startSurveyCtrl:focus{background-color:#000;color:#ccc;border-color:#999 #ccc #ccc #999}.noBackground{background-image:none}.loader{border:2.5em solid #fff;border-top:2.5em solid #013A81;border-radius:50%;width:2.3em;height:2.3em;animation:spin .4s linear infinite;position:fixed;top:50%;left:50%;margin-top:-4.8em;margin-left:-4.8em}.showTEl,h1,h2,h3{animation-name:thisAnimation}.logoHolder{height:5em;border:1px solid transparent;display:inline-block}.logoHolder a{border:none}.logo{height:5em;vertical-align:middle;margin-left:1em}h1,h2,h3{animation-duration:.4s}h2{font-size:.9em;margin-bottom:1em;text-transform:uppercase}h3{color:#320033}.survey{border:1px solid #999;border-top-width:5px;border-top-color:#BD2768;padding:15px;margin:1em auto 10em;background-color:rgba(238,238,238,.8)}.element,label{background-color:#fff}.element{border:1px dotted #eee;padding:.8em;margin:.95em auto;display:none;overflow:hidden}form,li{padding:5px}.show,.showTEl{display:block}@keyframes spin{0%{transform:rotate(0);opacity:0}100%{transform:rotate(360deg);opacity:1}}@keyframes thisAnimation{0%{-webkit-transform:rotateX(0);transform:rotateX(0);opacity:1}25%{-webkit-transform:rotateX(90deg);transform:rotateX(90deg);opacity:.75;background-color:#B42363}50%{-webkit-transform:rotateX(180deg);transform:rotateX(180deg);opacity:.5;background-color:rgba(180,35,99,.75)}75%{-webkit-transform:rotateX(270deg);transform:rotateX(270deg);opacity:.25;background-color:rgba(180,35,99,.5)}100%{-webkit-transform:rotateX(360deg);transform:rotateX(360deg);opacity:1;background-color:#fff}}.showTEl{animation-duration:.2s}.hide{display:none}label,td input{display:inline-block}.element:hover{box-shadow:1px 1px 3px #ccc;border-style:solid}form{border:1px solid #ccc;box-shadow:1px 1px 2px #ccc;margin:15px;background-color:#f2f2f2}label{border:1px solid #fff;border-radius:5px;padding:7px;margin:7px;cursor:pointer}label:hover{background-color:#BD2768;color:#fff;border-color:transparent}.questBtnHolder,.questionsCtrl{background-color:rgba(255,255,255,.3);text-align:center}table{margin:1em 10em 0 0;text-align:center}.table{overflow:auto}td,th{border:1px dotted #999;padding:3px;white-space:nowrap}td label{margin:0;border-radius:100%}li{list-style-type:none}span em{font-size:.8em;color:#999}.questBtnHolder{width:100%;position:fixed;bottom:0;left:0}.questionsCtrl{color:#320033;font-size:4em;border:1px solid transparent;box-shadow:1px 1px 5px #999;margin:.2em .15em}.questionsCtrl:hover{background-color:#320033;color:#fff;border-color:#320033;cursor:pointer}.questBtnHolder:hover .questionsCtrl{visibility:visible}.disabledQuestBtn{color:#ccc}.disabledQuestBtn:hover{background-color:rgba(255,255,255,.3);color:#ccc;border-color:transparent}textarea{width:100%;height:5em}.rating{font-size:2em;text-decoration:none;font-variant:normal;font-style:normal;color:green;margin-bottom:1em}a.rating{font-size:1em;color:#00f}		
		</style>
		<script>
			var tags="",elements=[],currEl=0,prevEl=-1,nextEl=1,surNdx=0;function getRadioGroup(a){tags="<form>";a.map(function(b){tags+="<label>"+b+"<input type='radio' name='group' value='"+b+"' /></label>"});return tags+="</form>"}function getMatrixCaption(a){var b="<th></th>";a.map(function(a){b+="<th>"+a+"</th>"});return b}function getMatrixRadio(a,b){var c="";a.map(function(a){c+="<td><label><input type='radio' name='"+b+"' /></label></td>"});return c}
			function getMatrix(a,b){tags="";a.map(function(c,d){tags+="<tr ><td>"+b[d]+"</td>"+getMatrixRadio(a,b[d])+"</tr>"});return tags="<div class='table'><table>"+getMatrixCaption(a)+tags+"</table></div>"}function getHeaders(a){var b="";a.name&&(b+="<h2>"+a.name+"</h2>");a.title&&(b+="<h3>"+a.title+"</h3>");return b}
			function getRating(a){return a.title?"<div class='rating'><strong onclick='enableRating()' data-value='1'>&#10023;</strong><strong onclick='enableRating()' data-value='2'>&#10023;</strong><strong onclick='enableRating()' data-value='3'>&#10023;</strong><strong onclick='enableRating()' data-value='4'>&#10023;</strong><strong onclick='enableRating()' data-value='5'>&#10023;</strong></div>"+a.title:"<div class='rating'><strong onclick='enableRating()' data-value='1'>&#10023;</strong><strong onclick='enableRating()' data-value='2'>&#10023;</strong><strong onclick='enableRating()' data-value='3'>&#10023;</strong><strong onclick='enableRating()' data-value='4'>&#10023;</strong><strong onclick='enableRating()' data-value='5'>&#10023;</strong></div><a href='#'>Please rate this survey</a>"}
			function getText(a){if(a.title)return a="<textarea>"+a.title+"</textarea>"}function getDropDown(a){tags="";tags+="<select>";a.map(function(b){tags+="<option value='"+b+"'>"+b+"</option>"});return tags+="</select>"}
			function getElementType(a){var b="";elements=[];a.map(function(a,d){elements.push({name:a.name,choices:a.choices,index:d});b+=0===d?"<div class='element showTEl'>":"<div class='element'>";switch(a.type){case "radiogroup":b+=getHeaders(a);b+=getRadioGroup(a.choices);break;case "matrix":b+=getHeaders(a);b+=getMatrix(a.columns,a.rows);break;case "text":b+=getHeaders(a);b+=getText(a);break;case "rating":b+=getHeaders(a);b+="<a href='#' class='rating'>"+getRating(a)+"</a>";break;case "dropdown":b+=getHeaders(a),
			b+=getDropDown(a.choices)}b+="</div>"});return b}
			function insertReply(a){var b="";b="<select onchange='switchSurvey()' id='selectSurvey'><option value='http://api.survey.services.joulecma.ca:8080/surveys?surveyId=1'>Survey No. 1</option><option value='http://api.survey.services.joulecma.ca:8080/surveys?surveyId=2'>Survey No. 2</option><option value='http://api.survey.services.joulecma.ca:8080/surveys?surveyId=972'>Survey No. 3</option></select>";b+="<span class='logoHolder'><a href='index.htm'><img class='logo' src='https://joule.cma.ca/content/joule/en/boilerplates/joule-header/_jcr_content/main_par/header/logo.img.png/1521126087297.png' alt='Joule Logo' /></a></span>";document.getElementsByTagName("BODY")[0].className=
			"noBackground";a.map(function(a,d){b+="<div class='survey'>";b+="<span>"+a.name+" <em>ID: "+a.surveyId+"</em></span>";b+=getElementType(a.elements);b+="</div><div class='loader'></div>"});b+="<div class='questBtnHolder'><span id='prevQuest' class='questionsCtrl disabledQuestBtn' onclick='prevQuestion()'>&#60;</span>";b+="<span id='nextQuest' class='questionsCtrl' onclick='nextQuestion()'>&#62;</span></div>";document.getElementsByTagName("BODY")[0].innerHTML=b;null!==document.getElementById("selectSurvey")&&
			(document.getElementById("selectSurvey").getElementsByTagName("option")[surNdx].selected=!0);nprocessing()}function prepareJSONP(a){processing();a||(a="http://api.survey.services.joulecma.ca:8080/surveys?surveyId=1");var b=document.createElement("script");b.src=a+"&callback=insertReply";document.body.appendChild(b)}
			function switchSurvey(){var a=document.getElementById("selectSurvey").selectedIndex;var b=document.getElementById("selectSurvey").getElementsByTagName("option")[a].value;prepareJSONP(b);currEl=0;prevEl=-1;nextEl=1;surNdx=a}function setThese(a,b,c){a&&(a.className=b,c)}
			function prevQuestion(){0<=prevEl?(setThese(document.getElementsByClassName("element")[currEl],"element",currEl--),setThese(document.getElementsByClassName("element")[prevEl],"element showTEl",prevEl--),setThese(document.getElementById("nextQuest"),"questionsCtrl",nextEl--),0==currEl&&-1==prevEl&&1==nextEl&&setThese(document.getElementById("prevQuest"),"questionsCtrl disabledQuestBtn",1)):setThese(document.getElementById("prevQuest"),"questionsCtrl disabledQuestBtn",1)}
			function nextQuestion(){nextEl<=elements.length-1?(setThese(document.getElementsByClassName("element")[currEl],"element",currEl++),setThese(document.getElementsByClassName("element")[nextEl],"element showTEl",nextEl++),setThese(document.getElementById("prevQuest"),"questionsCtrl",prevEl++),currEl==Number(elements.length-1)&&setThese(document.getElementById("nextQuest"),"questionsCtrl disabledQuestBtn",1)):setThese(document.getElementById("nextQuest"),"questionsCtrl disabledQuestBtn",1)}
			function enableRating(a){var b=b||window.event,c=b.target||b.srcElement;3==c.nodeType&&(c=c.parentNode);document.getElementsByClassName("rating")[1]&&(a=document.getElementsByClassName("rating")[1],Array.prototype.slice.call(a.getElementsByTagName("STRONG")).map(function(a,b){Number(b)<Number(c.getAttribute("data-value"))&&(a.innerHTML="&#10022;")}))}function processing(){setThese(document.getElementsByClassName("loader")[0],"loader show",0)}
			function nprocessing(){setThese(document.getElementsByClassName("loader")[0],"loader hide",0)};		
		</script>
		<!--<link href='styles.css' rel='stylesheet' type='text/css' />-->
		<!--<script src='script.js' type='text/javascript' defer async></script>-->
	</head>
	<body>
		<button id='startSurveyCtrl' onclick='prepareJSONP()'>Start</button>
		<div class='loader hide'></div>
	</body>
</html>
